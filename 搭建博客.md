# 使用Jekyll搭建博客，并绑定域名

- 参照[使用jekyll搭建个人博客](https://cloud.tencent.com/developer/article/1453573)
- 参照[在 Linux 上搭建Jekyll静态博客](https://segmentfault.com/a/1190000012560959)
- 参考[域名指向主机IP地址，通过域名:8080才能访问网站，去掉后面的8080；或者其他的端口号，直接使用域名访问网站](https://blog.csdn.net/panshoujia/article/details/91411484)
- 在用户权限下操作

## 环境

- CentOS Linux release 7.6.1810
- rvm 1.29.12
- gem 3.0.9
- ruby 2.7.0
- jekyll 3.9.0

## 安装curl

- 介绍：命令行工具，用来请求 Web 服务器。

- 安装：

  ```Linux
  sudo yum install curl
  ```

## 安装RVM（Ruby Version Manager）

- **第一步：**导入公钥服务器上的公钥（为了验证下载的文件是否准确，需要先从公钥服务器上下载对应的公钥，导入本地 GPG 服务器中，才能使用 GPG 完成对下载文件的验证）

  ```Linux
  gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3
  ```

- **第二步：**进行ssl认证

  ```Linux
  curl -sSL https://get.rvm.io | bash -s stable
  ```

  如果上面的命令执行失败，执行下面的命令

  ```Linux
  curl -L https://raw.githubusercontent.com/wayneeseguin/rvm/master/binscripts/rvm-installer | bash -s stable
  ```

  如果遇到下面的情况，说明第一步的公钥有误，那就先执行红色框框里的内容，然后再重新执行第二步。

  ![错误1](../pictures/搭建博客1.png)

- **第三步：**载入rvm

  在第二步正确执行之后，会如下所示：

  ![](../pictures/搭建博客2.png)

  载入rvm就是执行红色框框里的内容，根据输出提示，执行命令即可。我的是

  ```Linux
  source /home/xiaxia/.rvm/scripts/rvm
  ```

- **第四步：**检查rvm安装是否成功

  ```Linux
  rvm -v
  ```

## 安装Ruby

- **第一步：**查看已知的ruby版本

  ```Linux
  rvm list known
  ```

- **第二步：**检查安装需要

  ```Linux
  rvm requirements
  ```

- **第三步：**安装指定版本的Ruby，这里选择2.7.0版本（搭建博客版本需要）

  ```Linux
  rvm install 2.7.0
  ```

- **第四步：**如果以前安装过其他版本，设置Ruby版本。（如果上面的安装rvm时，载入rvm执行失败，则该命令不能执行成功）

  ```Linux
  rvm use 2.7.0 --default
  ```

- **第五步：**检查安装是否成功

  ```Linux
  ruby -v
  gem -v
  ```

## 安装Bundler

- 介绍：跟踪并安装所需的特定版本的 gem，以此来为 Ruby 项目提供一致的运行环境。（需要在用户环境下安装，不能是root）

- 安装：

  ```Linux
  gem install bundler
  ```

## 让博客跑起来

克隆主题，选择一个适合自己的主题就可，我这里选择的是码志的主题。

```Linux
git clone https://github.com/mzlogin/mzlogin.github.io.git
```

进入主题根目录

```Linux
cd mzlogin.github.io/
```

安装项目依赖的所有gem包

```Linux
bundle install
```

启动jekyll，并指定80端口号

```Linux
jekyll serve -H 0.0.0.0 -P 80
```

浏览器访问127.0.0.1即可。

这样启动的博客，关闭终端，博客就会关闭。可采用下面的命令脱离终端在后台运行。

```Linux
jekyll serve -H 0.0.0.0 -P 80 --detach
```

关闭使用下面的命令

```Linux
pkill -f jekyll
```

## 注册域名

购买一个域名，网上有很多步骤，这里不多做叙述。

域名注册完之后，备案、修改域名解析。这样我们就可以ping通这个网站了。

## 绑定域名

这个按照下载下来的jekyll博客配置就好，比如码志这个是修改CNAME文件。

修改完之后，重新启动jekyll，即可使用我们域名访问我们的博客。

## nginx反向代理

如果我们指定一个非80端口号，那么我们每次访问博客都需要使用域名+端口号的方式访问，很麻烦。

这个时候需要找到一个方法，让我们既能指定自己的端口号，也能直接通过域名访问。因为web默认是80端口。具体请看[nginx反向代理——将80端口请求转发到8080](https://blog.csdn.net/qq_36922927/article/details/79684812)

步骤：

- 打开nginx安装目录下的nginx.conf文件

  ```Linux
  vim nginx.conf
  ```

- 添加一个upstream webserver，server IP地址:开放端口号，我的是腾讯云服务器的IP地址

- 在下面的server组里的修改域名以及添加location组里的代理字段

![](../pictures/搭建博客4.png)

## 启动nginx

```Linux
sudo systemctl start nginx.service
```

可以通过域名访问博客了

![](../pictures/搭建博客5.png)



仅作测试用。



# 杂

- https://github.com/cotes2020/jekyll-theme-chirpy